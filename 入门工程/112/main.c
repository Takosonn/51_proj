#include <REGX52.H>
#include "delay.h"
#include "timer0.h"

#define SPEED  300
//	
unsigned int code Music[]={
//	17,4,
//		17,4,
//	  17,4,
//	  17,2,
//	  17,2,
//		18,4,
//		18,4,
//		18,4,
//	  18,2,
//	  18,2,
//		17,4,
//		17,4,
//	  17,4,
//	  17,2,
//	  17,2,
//	  15,4,
//	  15,4,
//	  15,4,
//		15,2,
//	  15,6,
//	0,4,
//	0,4,
//	13,4,
//	13,4,
//	17,4,
//	17,4,	
//	15,2,
//	13,4,
//	10,5,
//	8,1,
//	8,1,
//	8,1,
//	13,4,
//	13,4,
//	17,1,
//	17,4,
//	15,4,
//	0,4,
	0,4,
	0,4,
	0,4,
	13,4,
  13,2,
	13,2,
  17,4,
  17,4,
	15,2,
  13,4,
	10,4,
	8,2,
	10,2,
	13,2,
	15,4,
	13,4,
	17,2,
	17,3,
	0,2,
	13,6,
	0,4,
	0,4,
	17,2,
	20,6,
	25,8,
	0,4,
	18,2,
	17,6,
	13,8,
	0,4,
	17,2,
	20,6,
	25,6,
	25,4,
	18,2,
	22,6,
	20,6,
	0,4,
	0,4,
	0,4,
	17,2,
	20,6,
	25,8,
	0,4,
	18,2,
	17,6,
	13,8,
  0,4,
	17,2,
	20,4,
	20,4,
	20,2,
	20,2,
	17,2,
	22,2,
	20,6,
	0,16,
	17,2,
  20,6,
  25,8,
  0,4,
	18,2,
	17,6,
	13,8,
  0,4,
	17,2,
	20,6,
	25,6,
	25,4,
	24,2,
	22,6,
	20,8,
	0,8,
	17,2,
  20,6,
  25,8,
  0,4,
	18,2,
	17,6,
	13,8,
  0,4,
	15,3,
	13,1,
	15,3,
	13,1,
	15,4,
	17,4,
	18,4,
	0,4,
	17,4,
	15,4,
	17,8,
	20,4,
	25,4,
	18,4,
	17,4,
	15,4,
	13,4,
	17,8,
	20,4,
	25,4,
	24,4,
	24,4,
	22,4,
	20,4,
	17,8,
	20,4,
	25,4,
	18,14,
	17,4,
	15,14,
	17,4,
	18,8,
	17,4,
	15,4,
	13,32,
	
	
	
	0xff
};


unsigned int FreqTable[]={0,63738,63831,63935,64028,64121,64203,64285,64360,64431,64500,64563,64628,
													64690,64733,64784,64832,64877,64920,64960,64996,65034,65058,65100,65115,
													65140,65185,65210,65234,65257,65278,65298,65317,65335,65352,65368,65383};

sbit Buzzer=P2^5;

unsigned char FreqSelect,MusicSelect;
void main()
{
	timer0_init();			
	while(1)
		{
			if(Music[MusicSelect]!=0xff)
			{FreqSelect=Music[MusicSelect];	
			MusicSelect++;
			delay(SPEED/4*Music[MusicSelect]);
			MusicSelect++;
			TR0=0;
			delay(150);
			TR0=1;}
			else{
				TR0=0;
				while(1);
			}
		}
}	


void timer0_routine() interrupt 1
{
	if(FreqTable[FreqSelect]){
	TL0 = FreqTable[FreqSelect]%256;		//??????
	TH0 = FreqTable[FreqSelect]/256;		//??????
	Buzzer=!Buzzer;
	}
}

